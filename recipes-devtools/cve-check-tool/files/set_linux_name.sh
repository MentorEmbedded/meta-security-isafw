#!/bin/sh
KernelInfoList="$2"
IsafwReport="$1"
Mode="$3"
CustomName="$4"
## get all words starting with linux-
if [ "$Mode" != "Custom" ]; then
        KernelNames="$(cut -f 1,2 -d ',' $IsafwReport | grep ^linux- | sort | uniq)"
        echo "$KernelNames" ## echo to get in output and save it for custom case     
else
        KernelNames="$(cut -f 1,2 -d ',' $IsafwReport | grep linux_ | sort | uniq)"
fi

for Name in $KernelNames; do
        ## get word  from mentor_kernel_versions.txt to substitute with kernel name in faux
        if [ "$Mode" != "Custom" ]; then
                OrgName=$(grep ^$Name $KernelInfoList | cut -d' ' -f2) # get the linux_kernel, <Version>
                sed -i "s/$Name/$OrgName/g" $IsafwReport # custom to linux_kernel
        else
                for Custom in $CustomName; do
                	# match Version.I am assuming no two kernel of same version can be in a bsp
			if [ $(echo "$Custom" | cut -d',' -f2 | cut -d'-' -f1) = $(echo "$Name" | cut -d',' -f2 ) ]; then 
				sed -i "s/"$Name"/"$Custom"/g" $IsafwReport # linux_kernel to custom
                	fi
                done		
        fi
done
